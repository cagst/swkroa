<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="MembershipDuesRenewal" language="groovy" pageWidth="612" pageHeight="792" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="18747cb9-3756-4b8d-b28a-a2d3926be0e4">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="81"/>
	<queryString>
		<![CDATA[SELECT ms.membership_id
      ,ms.membership_name
      ,ms.fixed_dues
      ,ms.calculated_dues
      ,ms.effective_dues
      ,ms.balance
      ,p.dues_amount AS primary_dues_amount
      ,p.member_type_meaning AS primary_member_type_meaning
      ,ms.member_id
      ,ms.owner_ident
      ,ms.company_name
      ,ms.name_full AS primary_member_name
      ,pe.email_address AS primary_email
      ,pm.email_newsletter_ind
      ,pa.address1 AS primary_adress1
      ,pa.address2 AS primary_address2
      ,pa.address3 AS primary_address3
      ,pa.city AS primary_city
      ,pa.state_code AS primary_state
      ,pa.postal_code_formatted AS primary_postal_code
      ,pa.country_code AS primary_country
      ,NULLIF(s.member_name, '') AS spouse_name
      ,NULLIF(m.member_name, '') AS member_name
      ,m.name_full
      ,mpe.email_address AS member_email
      ,mpa.address1 AS member_address1
      ,mpa.address2 AS member_address2
      ,mpa.address3 AS member_address3
      ,mpa.city AS member_city
      ,mpa.state_code AS member_state
      ,mpa.postal_code_formatted AS member_postal_code
      ,mpa.country_code AS member_country
      ,m.dues_amount AS member_dues_amount
      ,NULLIF(CONCAT_WS(', ', mpa.address1, mpa.address2, mpa.address3, mpa.city, CONCAT_WS(' ', mpa.state_code, mpa.postal_code_formatted)), '') AS member_address
  FROM membership_summary ms
 INNER JOIN member_summary p ON (p.membership_id = ms.membership_id AND p.member_id = ms.member_id)
 INNER JOIN member pm ON (pm.member_id = ms.member_id)
  LEFT OUTER JOIN primary_address pa ON (pa.parent_entity_id = ms.member_id AND pa.parent_entity_name = 'MEMBER')
  LEFT OUTER JOIN primary_email pe ON (pe.parent_entity_id = ms.member_id AND pa.parent_entity_name = 'MEMBER')
  LEFT OUTER JOIN member_summary s ON (s.membership_id = ms.membership_id AND s.member_type_meaning = 'SPOUSE' AND s.active_ind = ms.active_ind)
  LEFT OUTER JOIN member_summary m ON (m.membership_id = ms.membership_id AND m.active_ind = ms.active_ind AND m.member_id != ms.member_id AND m.member_id != s.member_id)
  LEFT OUTER JOIN primary_address mpa ON (mpa.parent_entity_id = m.member_id AND mpa.parent_entity_name = 'MEMBER')
  LEFT OUTER JOIN primary_email mpe ON (mpe.parent_entity_id = m.member_id AND mpe.parent_entity_name = 'MEMBER')
 WHERE ms.active_ind = 1
ORDER BY ms.membership_name ASC;]]>
	</queryString>
	<field name="membership_id" class="java.math.BigInteger">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="membership_name" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="fixed_dues" class="java.math.BigDecimal"/>
	<field name="calculated_dues" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="effective_dues" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="balance" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="primary_dues_amount" class="java.math.BigDecimal"/>
	<field name="primary_member_type_meaning" class="java.lang.String"/>
	<field name="member_id" class="java.math.BigInteger">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="owner_ident" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="company_name" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="primary_member_name" class="java.lang.String"/>
	<field name="primary_email" class="java.lang.String"/>
	<field name="email_newsletter_ind" class="java.lang.Boolean">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="primary_adress1" class="java.lang.String"/>
	<field name="primary_address2" class="java.lang.String"/>
	<field name="primary_address3" class="java.lang.String"/>
	<field name="primary_city" class="java.lang.String"/>
	<field name="primary_state" class="java.lang.String"/>
	<field name="primary_postal_code" class="java.lang.String"/>
	<field name="primary_country" class="java.lang.String"/>
	<field name="spouse_name" class="java.lang.String"/>
	<field name="member_name" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="name_full" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="member_email" class="java.lang.String"/>
	<field name="member_address1" class="java.lang.String"/>
	<field name="member_address2" class="java.lang.String"/>
	<field name="member_address3" class="java.lang.String"/>
	<field name="member_city" class="java.lang.String"/>
	<field name="member_state" class="java.lang.String"/>
	<field name="member_postal_code" class="java.lang.String"/>
	<field name="member_country" class="java.lang.String"/>
	<field name="member_dues_amount" class="java.math.BigDecimal"/>
	<field name="member_address" class="java.lang.String"/>
	<variable name="CSZ" class="java.lang.String">
		<variableExpression><![CDATA[$F{primary_city} + ", " + $F{primary_state} + " " + $F{primary_postal_code}]]></variableExpression>
	</variable>
	<group name="membership">
		<groupExpression><![CDATA[$F{membership_id}]]></groupExpression>
		<groupHeader>
			<band height="213">
				<textField isBlankWhenNull="true">
					<reportElement x="40" y="0" width="246" height="20" isRemoveLineWhenBlank="true" uuid="c53bf91b-9457-4581-b4c6-5f4da289c1e5"/>
					<textElement>
						<font fontName="Verdana" size="12" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{company_name}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement x="40" y="20" width="246" height="20" isRemoveLineWhenBlank="true" uuid="92dfff3c-dd61-418a-8e35-25fd0b51a532"/>
					<textElement>
						<font fontName="Verdana" size="12" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{primary_member_name}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement x="40" y="40" width="246" height="20" isRemoveLineWhenBlank="true" uuid="bee39d5c-b93c-4191-bf18-a7a536384434"/>
					<textElement>
						<font fontName="Verdana" size="12" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{primary_adress1}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement x="40" y="60" width="246" height="20" isRemoveLineWhenBlank="true" uuid="db1cccde-6b60-4cdb-aa91-692f1af60e87"/>
					<textElement>
						<font fontName="Verdana" size="12" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{primary_address2}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement x="40" y="80" width="246" height="20" isRemoveLineWhenBlank="true" uuid="bf32c4b4-429c-4b25-99e5-4058b3ab2da1"/>
					<textElement>
						<font fontName="Verdana" size="12" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{primary_address3}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="40" y="100" width="246" height="20" uuid="91adad05-990c-4e71-a81a-926d738dbd0e"/>
					<textElement>
						<font fontName="Verdana" size="12" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{primary_city} + ", " + $F{primary_state} + " " + $F{primary_postal_code}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="40" y="142" width="188" height="20" uuid="0453e350-ab03-4093-aa12-ec6f6d9bf052"/>
					<textElement>
						<font fontName="Verdana" size="12"/>
					</textElement>
					<text><![CDATA[Spouse listed on membership: ]]></text>
				</staticText>
				<textField isBlankWhenNull="false">
					<reportElement x="228" y="142" width="129" height="20" uuid="9c285073-f625-418c-9ce2-f00379c20d6b"/>
					<textElement>
						<font fontName="Verdana" size="12" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{spouse_name} == null ? "None" : $F{spouse_name}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="40" y="162" width="188" height="20" uuid="61003a05-1b22-484b-b832-f51db64412e0"/>
					<textElement>
						<font fontName="Verdana" size="12"/>
					</textElement>
					<text><![CDATA[Email:]]></text>
				</staticText>
				<textField>
					<reportElement x="228" y="162" width="129" height="20" uuid="ce4546f6-28c1-46a0-b481-3eed5eb37c96"/>
					<textElement>
						<font fontName="Verdana" size="12" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{primary_email} == null ? "None" : $F{primary_email}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="40" y="182" width="317" height="20" uuid="f3a65cac-7c42-472e-b2a2-7539387a4160"/>
					<textElement>
						<font fontName="Verdana" size="12"/>
					</textElement>
					<text><![CDATA[Newsletter to be delivered via email listed above:]]></text>
				</staticText>
				<textField>
					<reportElement x="357" y="182" width="100" height="20" uuid="23f778f4-3780-4a86-9224-23bfb28fce6a"/>
					<textElement>
						<font fontName="Verdana" size="12" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{email_newsletter_ind} ? "Yes" : "No"]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<pageHeader>
		<band height="220" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="93" width="572" height="127" uuid="3f3bbeea-2cdc-468c-b37a-8103e059caf3"/>
				<textElement markup="styled">
					<font fontName="Verdana" size="12"/>
				</textElement>
				<text><![CDATA[It is time to renew your membership in the Southwest Kansas Royalty Owners Association. Your membership renewal fee for the period from <b>March 1, 2014</b> to <b>March 1, 2015</b> is shown below. Please make your check payable to <i>SWKROA</i> and return this form along with your payments to SWKROA. We have enclosed a self-addressed envelope for your convenience.

Please review and confirm the following membership information. <b>ONLY USE Membership New/Change Form for other changes to your membership.]]></text>
			</staticText>
		</band>
	</pageHeader>
	<detail>
		<band height="125" splitType="Stretch"/>
	</detail>
	<pageFooter>
		<band height="54" splitType="Stretch"/>
	</pageFooter>
</jasperReport>
